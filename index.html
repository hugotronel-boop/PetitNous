<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<title>Petit Nous</title>

<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
/* ==========================================================================
   1. VARIABLES & THEMES
   ========================================================================== */
:root {
  /* Mode Clair */
  --bg-gradient: linear-gradient(180deg, #fff7f2, #fdeee7);
  --card-bg: rgba(255, 255, 255, 0.65);
  --text-color: #3a2e2a;
  --title-color: #3a2e2a;
  --btn-bg: #e9a89b;
  --btn-shadow: rgba(233, 168, 155, 0.35);
  --input-bg: rgba(255, 255, 255, 0.8);
  --progress-bg: rgba(0, 0, 0, 0.05);
}

[data-theme="dark"] {
  /* Mode Sombre */
  --bg-gradient: linear-gradient(180deg, #2c2421, #1a1614);
  --card-bg: rgba(58, 46, 42, 0.8);
  --text-color: #fdeee7;
  --title-color: #ffffff;
  --btn-bg: #d08b7d;
  --btn-shadow: rgba(0, 0, 0, 0.3);
  --input-bg: rgba(255, 255, 255, 0.1);
  --progress-bg: rgba(255, 255, 255, 0.1);
}

/* ==========================================================================
   2. BASE & RESET
   ========================================================================== */
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  background: var(--bg-gradient);
  color: var(--text-color);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.3s ease;
  overflow-x: hidden;
}

.app {
  width: 100%;
  max-width: 390px;
  padding: 24px;
  box-sizing: border-box;
}

h1 {
  font-family: "Pacifico", cursive;
  font-size: 42px;
  text-align: center;
  margin: 0 0 12px 0;
  color: var(--title-color);
  transition: color 0.3s ease;
}

.subtitle, .parents-text {
  text-align: center;
  font-size: 15px;
  opacity: 0.8;
  margin-bottom: 24px;
}

/* ==========================================================================
   3. COMPOSANTS R√âUTILISABLES (Boutons, Cards, Inputs)
   ========================================================================== */
.card {
  background: var(--card-bg);
  border-radius: 26px;
  padding: 24px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.04);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  margin-bottom: 20px;
}

.btn {
  width: 100%;
  padding: 16px;
  border-radius: 20px;
  border: none;
  background: var(--btn-bg);
  color: white;
  font-size: 16px;
  font-weight: 500;
  cursor: pointer;
  box-shadow: 0 8px 18px var(--btn-shadow);
  transition: transform 0.2s, opacity 0.2s;
}

.btn:active { transform: translateY(2px); }

.btn-secondary {
  background: var(--input-bg);
  color: var(--text-color);
  border: 1px solid rgba(0, 0, 0, 0.06);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
}

/* Correction de l'alignement de tous les champs */
input, textarea, select {
  width: 100%;
  height: 52px; /* Hauteur fixe pour tout le monde */
  padding: 0 16px;
  border-radius: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: var(--input-bg);
  color: var(--text-color);
  font-size: 15px;
  margin-bottom: 16px;
  box-sizing: border-box; /* IMPORTANT : inclut le padding dans la largeur */
  display: block;
  appearance: none; /* Enl√®ve le style par d√©faut des navigateurs */
  -webkit-appearance: none;
}

textarea { 
  height: 100px; 
  padding: 16px; 
}

/* Correction sp√©cifique pour les champs date qui se comportent mal sur iPhone/Android */
input[type="date"] {
  display: flex;
  align-items: center;
  line-height: normal;
}

/* Style uniforme pour le s√©lecteur de fichier */
input[type="file"] {
  padding-top: 13px; /* Aligne le texte "Choisir un fichier" verticalement */
  cursor: pointer;
}

/* Style du bouton "Choisir un fichier" √† l'int√©rieur du cadre */
input[type="file"]::-webkit-file-upload-button {
  background: var(--btn-bg);
  border: none;
  border-radius: 8px;
  color: white;
  padding: 4px 8px;
  margin-right: 10px;
  font-size: 12px;
  cursor: pointer;
}

label {
  font-size: 13px;
  font-weight: 600;
  margin-bottom: 8px;
  display: block;
  opacity: 0.9;
}

.back-btn {
  background: var(--card-bg);
  border: none;
  border-radius: 50%;
  width: 44px; height: 44px;
  display: flex; align-items: center; justify-content: center;
  font-size: 20px; cursor: pointer;
  position: absolute; top: 20px; left: 20px; z-index: 10;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  color: var(--text-color);
}

/* ==========================================================================
   4. NAVIGATION & LISTES HORIZONTALES
   ========================================================================== */
.floating-buttons, .horizontal-scroll {
  display: flex;
  gap: 12px;
  overflow-x: auto;
  padding: 12px 5px;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
}

.floating-buttons::-webkit-scrollbar { display: none; }

.floating-buttons .btn {
  flex: 0 0 auto;
  min-width: 160px;
  scroll-snap-align: start;
}

/* ==========================================================================
   5. √âL√âMENTS SP√âCIFIQUES (Sexe, Timeline, Souvenirs)
   ========================================================================== */
/* Sexe du B√©b√© - VERSION CORRIG√âE */
.gender-choice {
  display: flex;
  gap: 8px;
  margin: 12px 0;
  width: 100%;
}

.gender-option {
  flex: 1; /* Force les 3 boutons √† faire la m√™me taille exacte */
  background: var(--input-bg);
  border-radius: 14px;
  padding: 8px 4px; 
  text-align: center;
  font-size: 13px; /* Un peu plus petit pour que "Surprise" ne d√©passe pas */
  cursor: pointer;
  transition: 0.3s;
  border: 1px solid rgba(0,0,0,0.05);
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 44px;
}

.gender-option input { 
  display: none; 
}

.gender-option span {
  display: block;
  width: 100%;
  padding: 6px 0;
  border-radius: 10px;
  transition: 0.2s;
}

/* Styles quand coch√© : on applique la couleur sur le span qui remplit le bouton */
.gender-option.boy input:checked + span { 
  background: #b3d9ff; 
  color: #004085; 
}

.gender-option.girl input:checked + span { 
  background: #ffd6e7; 
  color: #85144b; 
}

.gender-option.neutral input:checked + span { 
  background: #e6e6e6; 
  color: #333; 
}

/* Timeline */
.week-card {
  background: var(--card-bg);
  border-radius: 20px;
  padding: 16px;
  margin-bottom: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-left: 5px solid transparent;
}

.trimester1 { border-left-color: #e9a89b; }
.trimester2 { border-left-color: #f4c542; }
.trimester3 { border-left-color: #3a2e2a; }

/* Progress Bar */
.progress-container {
  width: 100%;
  height: 12px;
  background: var(--progress-bg);
  border-radius: 10px;
  margin: 15px 0;
  overflow: hidden;
}

.progress-bar {
  height: 100%;
  background: var(--btn-bg);
  transition: width 0.5s ease;
}

/* Checklist & Pr√©noms */
.checklist-item, .prenom-item {
  background: var(--card-bg);
  border-radius: 16px;
  padding: 12px 16px;
  margin-bottom: 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.gender.garcon { background: #b3d9ff; color: #004085; }
.gender.fille { background: #ffd6e7; color: #85144b; }
.gender.mixte { background: #eee; color: #444; }

/* ==========================================================================
   6. UTILITAIRES & MODAL
   ========================================================================== */
.page { display: none; }
.page.active { display: block; animation: fadeIn 0.4s ease; }

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

#imageModal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.9);
  z-index: 9999;
  padding: 20px;
}

.footer {
  text-align: center;
  font-size: 13px;
  opacity: 0.6;
  margin-top: 30px;
  padding-bottom: 20px;
}
</style>
</head>

<body>
<div class="app">
  <!-- Page 1: D√©marrage -->
  <div id="page1" class="page active">
    <h1>Petit Nous</h1>
    <div class="subtitle">
      Chaque histoire commence quelque part ü§ç
    </div>

    <div class="card">

      <button class="btn" onclick="saveParentsName()">
        Commencer l'aventure ‚ú®
      </button>
    </div>

    <div class="footer">
      Un espace intime, juste pour vous.
    </div>
  </div>

  <!-- Page 2: Accueil -->
  <div id="page2" class="page">
    
    <button id="themeToggle" class="btn-secondary" style="width: auto; padding: 10px; border-radius: 50%;">
  üåô
</button>

    <div class="header">
      <h1>Petit Nous</h1>
      <div class="parents-text" id="parentsText">Hugo & Charline attendent leur petit b√©b√© ü•π</div>
<p style="text-align:center;">Chaque jour nous rapproche de toi</p>    </div>

    <div class="card">
      <div class="week" id="weekText">Semaine 0</div>
      <div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
<div class="due-date" id="dueDateText">
  <strong>Terme estim√© :</strong> --
</div>

<div class="weeks-left" id="weeksLeftText">
  <strong>Encore :</strong> -- semaines ü•∞
</div>
      <div class="baby-size" id="babySize">B√©b√© est petit comme une graine üå±</div>
      <div class="tip" id="tipText">N'oubliez pas de prendre votre photo hebdo ü§ç</div>

<div class="section">
  <label><strong>Sexe du b√©b√©</strong></label>

  <div class="gender-choice">
<label class="gender-option boy">
  <input type="radio" name="babyGender" value="Gar√ßon">
  <span>üë¶ Gar√ßon</span>
</label>
<label class="gender-option girl">
  <input type="radio" name="babyGender" value="Fille">
  <span>üëß Fille</span>
</label>
<label class="gender-option neutral">
  <input type="radio" name="babyGender" value="Surprise">
  <span>ü§ç Surprise</span>
</label>
  </div>
</div>

      <div class="edit-section">
        <button type="button" onclick="showEdit()">Modifier la date de d√©but</button>
        <div id="editContainer" style="display:none;">
          <input type="date" id="editDate" />
          <button type="button" onclick="updateStartDate()">Valider</button>
        </div>
      </div>
    </div>

<div class="buttons-container">
<div class="floating-buttons">
  <button class="btn" onclick="showPage('page4')">‚úçÔ∏è Ajouter un souvenir</button>
  <button class="btn btn-secondary" onclick="showPage('page3')">üìÜ Voir la timeline</button>
  <button class="btn btn-secondary" onclick="showPage('page5')">üìù Journal de grossesse</button>
  <button class="btn btn-secondary" onclick="showPage('page6')">üìÖ Carnet de rendez-vous</button>
  <button class="btn btn-secondary" onclick="showPage('page7')">üìã Checklist maternit√©</button> 
  <button class="btn btn-secondary" onclick="showPage('page8')">üë∂ Pr√©noms favoris</button>
</div>
</div>
    <div class="footer">Un jour, tu liras tout √ßa ‚ù§Ô∏è</div>
  </div>
  
  <!-- Page 3: Timeline -->
  <div id="page3" class="page">
    <button class="back-btn" onclick="showPage('page2')">‚Üê</button>
    
    <h1>Timeline</h1>
    <div id="timeline"></div>
  </div>

  <!-- Page 4: Souvenirs -->
  <div id="page4" class="page">
    <button class="back-btn" onclick="showPage('page2')">‚Üê</button>
    
    <div class="header">
      <h1>Petit Nous</h1>
      <div class="parents-text" id="souvenirParentsText">Hugo & Charline cr√©ent leurs souvenirs ü•π</div>
      <p>Chaque moment compte üíõ</p>
    </div>

    <div class="card">
      <div class="add-souvenir">
        <input id="souvenirText" placeholder="√âcris ton souvenir">
        <input id="souvenirDate" type="date">
        <input id="babySizeInput" type="number" placeholder="Taille b√©b√© (cm)">
        <input id="souvenirPhoto" type="file" accept="image/*">
        <div id="photoPreview"></div>
        <button id="addButton">Ajouter le souvenir</button>
      </div>

      <button id="toggleButton" class="btn btn-secondary" style="margin-top:12px;">Lire les souvenirs</button>
      <button id="saveButton" class="btn" style="margin-top:12px;">Enregistrer s√©lection</button>

      <div id="souvenirList" class="souvenir-list"></div>
    </div>

    <!-- MODAL -->
    <div id="imageModal">
      <div>
        <img id="modalImage">
        <div>
          <button id="closeModal">Fermer</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Page 5: Journal -->
  <div id="page5" class="page">
    <button class="back-btn" onclick="showPage('page2')">‚Üê</button>
    
    <h1>üìù Journal de grossesse</h1>

    <div class="note-card">
      <label for="note">Notes libres :</label>
      <textarea id="note" placeholder="√âcris ce que vous ressentez..."></textarea>

      <label for="date">Date :</label>
      <input type="date" id="journalDate">

      <label for="emotion">Niveau d'√©motion :</label>
      <select id="emotion">
        <option value="">-- Choisir --</option>
        <option value="üòç">üòç Tr√®s heureux(se)</option>
        <option value="üòä">üòä Heureux(se)</option>
        <option value="üòê">üòê Neutre</option>
        <option value="üòü">üòü Un peu inquiet(e)</option>
        <option value="üò¢">üò¢ Triste</option>
      </select>

      <label for="author">Auteur :</label>
      <select id="author">
        <option value="">-- Choisir --</option>
        <option value="Hugo">Hugo</option>
        <option value="Charline">Charline</option>
        <option value="Nous deux">Nous deux</option>
      </select>

      <button id="saveNote">Ajouter au journal</button>
    </div>

    <div id="journal"></div>

    <div class="footer">Chaque √©motion compte ü§ç</div>
  </div>
  
  <!-- Page 6: Carnet de rendez-vous -->
<div id="page6" class="page">
  <button class="back-btn" onclick="showPage('page2')">‚Üê</button>
  
  <h1>üìÖ Carnet de rendez-vous</h1>

  <div class="note-card">
    <label for="rdvDate">Date :</label>
    <input type="date" id="rdvDate">

    <label for="rdvTime">Heure :</label>
    <input type="time" id="rdvTime">

<select id="rdvType">
  <option value="">-- Choisir le type --</option>

  <optgroup label="ü©∫ Suivi m√©dical">
    <option>Consultation m√©dicale</option>
    <option>√âchographie</option>
    <option>Analyse / prise de sang</option>
    <option>Vaccination</option>
    <option>Suivi sage-femme</option>
  </optgroup>

  <optgroup label="üß† Bien-√™tre">
    <option>Pr√©paration √† l'accouchement</option>
    <option>Psychologue</option>
    <option>Ost√©opathe / Kin√©</option>
  </optgroup>

  <optgroup label="üè• Administratif">
    <option>Rendez-vous maternit√©</option>
    <option>D√©marches administratives</option>
  </optgroup>

  <optgroup label="üë∂ Apr√®s naissance">
    <option>Suivi p√©diatrique</option>
    <option>Contr√¥le post-natal maman</option>
  </optgroup>

  <option>‚≠ê Autre</option>
</select>

    <label for="rdvNote">Notes :</label>
    <textarea id="rdvNote" placeholder="√âcris les infos importantes..."></textarea>

    <button id="saveRdv">Ajouter le rendez-vous</button>
  </div>

  <div id="rdvList"></div>
</div>

<!-- Page 7: Checklist maternit√© -->
<div id="page7" class="page">
  <button class="back-btn" onclick="showPage('page2')">‚Üê</button>

  <h1>üìã Checklist maternit√©</h1>

  <div class="card">
    <!-- Formulaire d'ajout -->
    <div class="add-checklist">
      <input type="text" id="checklistInput" placeholder="Ajouter un item...">

      <select id="checklistCategory">
        <option value="">-- Choisir une cat√©gorie --</option>
        <option value="V√™tements b√©b√©">V√™tements b√©b√©</option>
        <option value="Accessoires">Accessoires</option>
        <option value="Hygi√®ne">Hygi√®ne</option>
        <option value="Autre">Autre...</option>
      </select>

      <input type="text" id="checklistCustomCategory" placeholder="√âcris ta cat√©gorie" style="display:none;">

      <button id="addChecklistBtn" class="btn">Ajouter</button>
    </div>

    <!-- Container pour afficher les items -->
    <div id="checklistContainer" style="margin-top:16px;"></div>
  </div>
</div>

<!-- PAGE 8 : Pr√©noms favoris -->
<div id="page8" class="page">
  <button class="back-btn" onclick="showPage('page2')">‚Üê</button>
  <h1>üë∂ Liste de pr√©noms</h1>

  <!-- Ajout pr√©nom -->
  <div class="add-prenom">
    <input type="text" id="prenomInput" placeholder="√âcris un pr√©nom...">
    <select id="prenomGenre">
      <option value="mixte">Mixte</option>
      <option value="garcon">Gar√ßon</option>
      <option value="fille">Fille</option>
    </select>
    <button id="addPrenomBtn" class="btn">Ajouter</button>
  </div>

  <!-- Filtres -->
  <div class="filter-prenom" style="margin-top:12px;">
    <button class="btn btn-secondary" data-filter="all">Tous</button>
    <button class="btn btn-secondary" data-filter="garcon">Gar√ßon</button>
    <button class="btn btn-secondary" data-filter="fille">Fille</button>
    <button class="btn btn-secondary" data-filter="mixte">Mixte</button>
    <button class="btn btn-secondary" data-filter="fav">‚≠ê Favoris</button>
  </div>

  <!-- Liste des pr√©noms -->
  <div id="prenomContainer" style="margin-top:16px;"></div>
</div>

<script>
// ==========================================================================
// LOCALSTORAGE - AJOUT√â SANS MODIFIER LE CODE EXISTANT
// ==========================================================================

// Fonction pour sauvegarder toutes les donn√©es dans localStorage
function saveAllData() {
  try {
    const appData = {
      // Donn√©es de base
      startDate: storedStartDate,
      parentsName: parentsName,
      babyGender: babyGender,
      
      // Collections
      souvenirs: souvenirs,
      journalEntries: journalEntries,
      rdvEntries: rdvEntries,
      checklistItems: checklistItems,
      prenoms: prenoms,
      
      // Th√®me
      theme: document.documentElement.getAttribute('data-theme') || 'light',
      
      // Date de derni√®re sauvegarde
      lastSave: new Date().toISOString()
    };
    
    localStorage.setItem('petitNousData', JSON.stringify(appData));
    console.log('Donn√©es sauvegard√©es dans localStorage');
  } catch (error) {
    console.error('Erreur lors de la sauvegarde:', error);
  }
}

// Fonction pour charger toutes les donn√©es depuis localStorage
function loadAllData() {
  try {
    const saved = localStorage.getItem('petitNousData');
    if (saved) {
      const appData = JSON.parse(saved);
      
      // Donn√©es de base
      storedStartDate = appData.startDate || '';
      parentsName = appData.parentsName || '';
      babyGender = appData.babyGender || '';
      
      // Collections
      souvenirs = appData.souvenirs || [];
      journalEntries = appData.journalEntries || [];
      rdvEntries = appData.rdvEntries || [];
      checklistItems = appData.checklistItems || [];
      prenoms = appData.prenoms || [];
      
      // Th√®me
      if (appData.theme === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
        themeToggle.textContent = '‚òÄÔ∏è';
      }
      
      console.log('Donn√©es charg√©es depuis localStorage');
      return true;
    }
  } catch (error) {
    console.error('Erreur lors du chargement:', error);
  }
  return false;
}

// Fonctions wrapper pour sauvegarder apr√®s chaque modification
function saveWithStorage(callback) {
  return function(...args) {
    const result = callback.apply(this, args);
    saveAllData();
    return result;
  };
}

// Envelopper les fonctions existantes pour qu'elles sauvegardent automatiquement
const originalUpdateStartDate = updateStartDate;
updateStartDate = saveWithStorage(originalUpdateStartDate);

const originalAddSouvenir = addSouvenir;
addSouvenir = saveWithStorage(originalAddSouvenir);

const originalSaveJournalEntry = saveJournalEntry;
saveJournalEntry = saveWithStorage(originalSaveJournalEntry);

const originalSaveRdvEntry = saveRdvEntry;
saveRdvEntry = saveWithStorage(originalSaveRdvEntry);

// ==========================================================================
// CODE EXISTANT - NON MODIFI√â
// ==========================================================================

const themeToggle = document.getElementById('themeToggle');
const body = document.documentElement; // On applique le th√®me sur <html>

themeToggle.addEventListener('click', () => {
  if (body.getAttribute('data-theme') === 'dark') {
    body.removeAttribute('data-theme');
    themeToggle.textContent = 'üåô';
  } else {
    body.setAttribute('data-theme', 'dark');
    themeToggle.textContent = '‚òÄÔ∏è';
  }
  saveAllData(); // Ajout: sauvegarde du th√®me
});

function saveParentsName() {
  // juste passer √† la page 2
  showPage('page2');
}
let babyGender = "";

function formatDateTime(dateStr, timeStr) {
  const date = new Date(dateStr + "T" + timeStr);

  return date.toLocaleDateString("fr-FR", {
    day: "numeric",
    month: "long"
  }) + " √† " + timeStr;
}

  // Variables globales
  let currentPage = 'page1';
  let startDate = null;
  let souvenirs = [];
  let editIndex = null;
  let currentPhoto = null;
  let journalEntries = [];
  let parentsName = '';
  let storedStartDate = '';
  
function updateParentsText() {
  document.getElementById("parentsText").textContent =
    (parentsName || "Hugo & Charline") + " attendent leur petit miracle ü•π";
}

  const tips = [
    "N'oubliez pas de prendre votre photo hebdo ü§ç",
    "Cette semaine, b√©b√© bouge un peu plus ! üíÉ",
    "Hydratez-vous bien üíß",
    "Mangez une portion de fruits suppl√©mentaire üçé",
    "Profitez d'un moment calme ensemble üïäÔ∏è",
    "B√©b√© entend des sons, parlez-lui doucement üé∂",
    "C'est le moment parfait pour un peu de yoga doux üßò‚Äç‚ôÄÔ∏è",
    "Choisissez une chanson sp√©ciale pour b√©b√© üéµ",
    "Restez actif, m√™me une petite marche fait du bien üö∂‚Äç‚ôÇÔ∏è",
    "Pr√©parez votre coin cosy pour b√©b√© üçº"
  ];

  // Initialisation au chargement
window.onload = function() {
    // Charger les donn√©es depuis localStorage
    loadAllData();
    
    // Initialiser les √©couteurs d'√©v√©nements une seule fois
    initSouvenirsPage();
    initJournalPage();
    initRdvPage();
    // On ne lance pas initChecklist ou initPrenoms ici, 
    // car ils sont lanc√©s par showPage quand on clique sur le bouton.
    
// Toujours commencer par la page 1 (pas de donn√©es persistantes)
showPage('page1');
};

function initGenderChoice() {
  const radios = document.querySelectorAll('input[name="babyGender"]');

  radios.forEach(radio => {
    radio.addEventListener("change", () => {
      babyGender = radio.value;
      console.log("Sexe choisi :", babyGender);
      saveAllData(); // Ajout: sauvegarde du sexe
    });
  });
}
    
    // Toujours commencer par la page 1 (pas de donn√©es persistantes)
    showPage('page1');

  // Fonctions de navigation
function showPage(pageId) {
    // Cacher toutes les pages
    document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
    });

    // Afficher la page demand√©e
    const targetPage = document.getElementById(pageId);
    if (!targetPage) {
        console.error("La page avec l'id '" + pageId + "' n'existe pas !");
        return;
    }
    targetPage.classList.add('active');
    currentPage = pageId;

    // Lancer l'initialisation sp√©cifique √† chaque page
    switch(pageId) {
        case 'page2':
            initMainPage();
            initGenderChoice(); // Ajout√© pour le sexe du b√©b√©
            break;
        case 'page3':
            initTimelinePage();
            break;
        case 'page4':
            updateSouvenirParentsText();
            renderSouvenirList();
            break;
        case 'page5':
            renderJournalEntries();
            break;
        case 'page6':
            renderRdvEntries();
            break;
        case 'page7':
            initChecklistPage(); // Correction ici
            break;
        case 'page8':
            initPrenomsPage(); // Correction ici
            break;
    }
}

// Fonction de retour
function goBack() {
    if (currentPage === 'page2') {
        showPage('page1');
    } else if (['page3','page4','page5','page6','page7','page8'].includes(currentPage)) {
        showPage('page2');
    }
}

  // Page 2: Accueil principal

function initMainPage() {
  if (storedStartDate) {
    startDate = new Date(storedStartDate);
    document.getElementById("editDate").value = storedStartDate;
    updatePregnancyInfo();
  }

  updateParentsText();
}

  function showEdit() {
    document.getElementById("editContainer").style.display = "flex";
  }

  function updateStartDate() {
    const newDate = document.getElementById("editDate").value;
    if (!newDate) return alert("Choisis une date ü§ç");

    startDate = new Date(newDate);
    storedStartDate = newDate;
    document.getElementById("editContainer").style.display = "none";
    updatePregnancyInfo();
  }

  function updatePregnancyInfo() {
    if (!startDate) return;

    const today = new Date();
    const diffTime = today - startDate;
    const diffDays = Math.floor(diffTime / (1000*60*60*24));
    const currentWeek = Math.max(1, Math.floor(diffDays / 7) + 1);

    document.getElementById("weekText").textContent = "Semaine " + currentWeek;

    // Barre de progression
    const progressPercent = Math.min(100, (currentWeek / 40) * 100);
    document.getElementById("progressBar").style.width = progressPercent + "%";

    const due = new Date(startDate.getTime() + 280*24*60*60*1000);
document.getElementById("dueDateText").innerHTML =
  "<strong>Terme estim√© :</strong> " + due.toLocaleDateString('fr-FR');
    const weeksLeft = Math.max(0, 40 - currentWeek);
document.getElementById("weeksLeftText").innerHTML =
  "<strong>Encore :</strong> " + weeksLeft + " semaines ü•∞";
    // Emoji b√©b√©
const babySize = document.getElementById("babySize");
if (currentWeek <= 4) babySize.innerHTML = "<strong>B√©b√© est petit comme une graine üå±</strong>";
else if (currentWeek <= 8) babySize.innerHTML = "<strong>B√©b√© est grand comme une myrtille ü´ê</strong>";
else if (currentWeek <= 12) babySize.innerHTML = "<strong>B√©b√© est grand comme un kiwi ü•ù</strong>";
else if (currentWeek <= 16) babySize.innerHTML = "<strong>B√©b√© est grand comme un avocat ü•ë</strong>";
else if (currentWeek <= 20) babySize.innerHTML = "<strong>B√©b√© est grand comme une banane üçå</strong>";
else if (currentWeek <= 24) babySize.innerHTML = "<strong>B√©b√© est grand comme un √©pi de ma√Øs üåΩ</strong>";
else if (currentWeek <= 28) babySize.innerHTML = "<strong>B√©b√© est grand comme une aubergine üçÜ</strong>";
else if (currentWeek <= 32) babySize.innerHTML = "<strong>B√©b√© est grand comme une courgette ü•í</strong>";
else if (currentWeek <= 36) babySize.innerHTML = "<strong>B√©b√© est grand comme une papaye ü•≠</strong>";
else babySize.innerHTML = "<strong>B√©b√© est presque pr√™t ! üçº</strong>";

    // Tip hebdo (cycle sur le tableau)
    const tipIndex = (currentWeek - 1) % tips.length;
    document.getElementById("tipText").textContent = tips[tipIndex];
  }

// ============================
// Sexe du b√©b√©
// ============================
function initGenderChoice() {
  const radios = document.querySelectorAll('input[name="babyGender"]');
  radios.forEach(radio=>{
    radio.addEventListener("change",()=>{
      babyGender = radio.value;
      // on applique la couleur via CSS d√©j√† pr√©sent (has input:checked)
      console.log("Sexe choisi :",babyGender);
    });
  });
}


  // Page 3: Timeline
  function initTimelinePage() {
  const timeline = document.getElementById('timeline');
  timeline.innerHTML = '';

  if (!startDate) return; // si pas de date de d√©but, ne rien afficher

  const today = new Date();
  const diffDays = Math.floor((today - startDate) / (1000*60*60*24));
  const currentWeek = Math.min(40, Math.max(1, Math.floor(diffDays/7)+1));

  // Exemple de tailles pour chaque semaine (cm)
  const babySizes = [
    0.1,0.2,0.4,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,
    22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40
  ];

  function getEmoji(size){
    if(size <= 2) return "üå±";
    if(size <= 5) return "ü´ê";
    if(size <= 7) return "ü•ù";
    if(size <= 11) return "ü•ë";
    if(size <= 16) return "üçå";
    if(size <= 25) return "üåΩ";
    if(size <= 30) return "üçÜ";
    if(size <= 35) return "ü•í";
    if(size <= 40) return "ü•≠";
    return "üçº";
  }
  
// Mois en mots pour la timeline
const monthsInWords = [
  "1 mois",
  "2 mois",
  "3 mois",
  "4 mois",
  "5 mois",
  "6 mois",
  "7 mois",
  "8 mois",
  "9 mois"
];

  for (let week = 1; week <= 40; week++) {
    const card = document.createElement('div');
    card.className = 'week-card';

    // Trimestres
    if (week <= 12) card.classList.add('trimester1');
    else if (week <= 27) card.classList.add('trimester2');
    else card.classList.add('trimester3');

    // Affichage du mois seulement au d√©but de chaque mois
let monthText = "";
const weekDiff = week - 1; // combien de semaines depuis le d√©but
const monthIndex = Math.floor(weekDiff / 4.33);
// Afficher le mois uniquement si c'est la premi√®re semaine du mois
if (weekDiff % 4.33 < 1 && monthIndex < monthsInWords.length) {
    monthText = monthsInWords[monthIndex];
}

    const size = babySizes[week-1];
    const emoji = getEmoji(size);

    // Couleur selon la semaine
    if (week < currentWeek) {
      card.style.background = "rgba(233,168,155,0.8)"; // d√©j√† pass√©e
    } else if (week === currentWeek) {
      card.style.background = "rgba(233,168,155,1)"; // semaine actuelle
      card.style.color = "#fff";
    } else {
      card.style.background = "rgba(255,255,255,0.75)"; // futur
    }

    card.innerHTML = `<div class="week-number">Semaine ${week}</div>
                      <div class="week-month">${monthText}</div>
                      <div class="week-size">${size} cm ${emoji}</div>`;
    timeline.appendChild(card);
  }
}
  // Page 4: Souvenirs
  function initSouvenirsPage() {
    const souvenirPhoto = document.getElementById("souvenirPhoto");
    const photoPreview = document.getElementById("photoPreview");
    const addButton = document.getElementById("addButton");
    const toggleButton = document.getElementById("toggleButton");
    const saveButton = document.getElementById("saveButton");
    
    souvenirPhoto.onchange = () => {
      const file = souvenirPhoto.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        currentPhoto = e.target.result;
        photoPreview.innerHTML = `<img src="${currentPhoto}">`;
      };
      reader.readAsDataURL(file);
    };

    addButton.onclick = addSouvenir;
    toggleButton.onclick = toggleSouvenirList;
    saveButton.onclick = saveSouvenirsSelection;
    
    // Pas de chargement depuis localStorage
  }

  function updateSouvenirParentsText() {
    document.getElementById("souvenirParentsText").textContent = (parentsName || "Hugo & Charline") + " cr√©ent leurs souvenirs ü•π";
  }

  function sizeToEmoji(size){
    if(!size) return '';
    if(size < 20) return 'üçì';
    if(size < 30) return 'üçê';
    if(size < 40) return 'üçä';
    return 'üë∂';
  }

function renderSouvenirList() {
  const souvenirList = document.getElementById("souvenirList");
  souvenirList.innerHTML = "";

  souvenirs.forEach((s,index)=>{
    const div = document.createElement("div");
    div.className = "souvenir";

    // Photo du souvenir
    if(s.photo){
      const img = document.createElement("img");
      img.src = s.photo;
      div.appendChild(img);
    }

    // Label + checkbox
    const label = document.createElement("label");
    label.style.display = "flex";
    label.style.alignItems = "center";
    label.style.gap = "10px";
    label.style.flex = "1";
    label.style.padding = "8px";
    label.style.borderRadius = "14px";
    label.style.transition = "0.2s";
    label.style.cursor = "pointer";

    const check = document.createElement("input");
    check.type = "checkbox";
    check.dataset.index = index;

    // Quand coch√© ‚Üí on change le style du label
    check.addEventListener("change", () => {
      if(check.checked){
        label.style.background = "rgba(233,168,155,0.3)";
      } else {
        label.style.background = "transparent";
      }
    });

    const span = document.createElement("span");
    span.innerHTML = `${s.text} <div style="font-size:12px;opacity:.7">Taille : ${s.size || "?"} cm ${sizeToEmoji(s.size)}</div>
                      <div style="font-size:12px;opacity:.6">${s.date}</div>`;

    label.appendChild(check);
    label.appendChild(span);
    div.appendChild(label);

    // Actions (Modifier/Supprimer)
    const actions = document.createElement("div");
    actions.className = "actions";

    const edit = document.createElement("button");
    edit.textContent = "Modifier";
    edit.className = "edit";
    edit.onclick = () => {
      document.getElementById("souvenirText").value = s.text;
      document.getElementById("souvenirDate").value = s.date;
      document.getElementById("babySizeInput").value = s.size || "";
      currentPhoto = s.photo;
      document.getElementById("photoPreview").innerHTML = s.photo ? `<img src="${s.photo}">` : "";
      document.getElementById("addButton").textContent = "Mettre √† jour";
      editIndex = index;
    };

    const del = document.createElement("button");
    del.textContent = "Supprimer";
    del.className = "delete";
    del.onclick = () => {
      if(confirm("Supprimer ce souvenir ?")){
        souvenirs.splice(index,1);
        renderSouvenirList();
        saveAllData(); // Ajout: sauvegarde apr√®s suppression
      }
    };

    actions.append(edit, del);
    div.appendChild(actions);

    // Ajout au DOM
    souvenirList.appendChild(div);
  });
}

  function addSouvenir() {
    const souvenirText = document.getElementById("souvenirText").value;
    const souvenirDate = document.getElementById("souvenirDate").value;
    const babySizeInput = document.getElementById("babySizeInput").value;

    if(!souvenirText || !souvenirDate) return alert("Remplis tout ü§ç");

    const data = {
      text: souvenirText,
      date: souvenirDate,
      size: babySizeInput,
      photo: currentPhoto
    };

    if(editIndex !== null){
      souvenirs[editIndex] = data;
      editIndex = null;
      document.getElementById("addButton").textContent = "Ajouter le souvenir";
    } else {
      souvenirs.push(data);
    }

    // R√©initialiser les champs
    document.getElementById("souvenirText").value = "";
    document.getElementById("souvenirDate").value = "";
    document.getElementById("babySizeInput").value = "";
    document.getElementById("souvenirPhoto").value = "";
    document.getElementById("photoPreview").innerHTML = "";
    currentPhoto = null;

    renderSouvenirList();
  }

  function toggleSouvenirList() {
    const souvenirList = document.getElementById("souvenirList");
    souvenirList.style.display =
      souvenirList.style.display === "block" ? "none" : "block";
  }

  async function saveSouvenirsSelection() {
    const selected = Array.from(
      document.getElementById("souvenirList").querySelectorAll("input[type=checkbox]:checked")
    );

    if (!selected.length) return alert("S√©lectionne au moins un souvenir ü§ç");

    const exportBox = document.createElement("div");
    exportBox.style.position = "fixed";
    exportBox.style.top = "-9999px";
    exportBox.style.width = "360px";
    exportBox.style.padding = "20px";
    exportBox.style.background = "#fff";

    selected.forEach(cb => {
      const s = souvenirs[cb.dataset.index];
      const block = document.createElement("div");
      block.style.marginBottom = "16px";
      block.style.border = "1px solid #ddd";
      block.style.borderRadius = "12px";
      block.style.padding = "12px";

      if(s.photo){
        const img = document.createElement("img");
        img.src = s.photo;
        img.style.width = "100%";
        img.style.borderRadius = "10px";
        img.style.marginBottom = "8px";
        block.appendChild(img);
      }

      block.innerHTML += `
        <div>${s.text}</div>
        <div style="font-size:13px;opacity:.7">Taille : ${s.size || "?"} cm ${sizeToEmoji(s.size)}</div>
        <div style="font-size:12px;opacity:.6">${s.date}</div>
      `;
      exportBox.appendChild(block);
    });

    document.body.appendChild(exportBox);
    const canvas = await html2canvas(exportBox,{scale:2,backgroundColor:"#fff"});
    document.body.removeChild(exportBox);

    const imgData = canvas.toDataURL("image/jpeg",1.0);
    document.getElementById("modalImage").src = imgData;
    document.getElementById("imageModal").style.display = "block";
  }

  function downloadImage() {
    const imgData = document.getElementById("modalImage").src;
    const a = document.createElement("a");
    a.href = imgData;
    a.download = "souvenirs.jpeg";
    a.click();
  }
  
  // Fermer le modal
document.getElementById("closeModal").addEventListener("click", () => {
  document.getElementById("imageModal").style.display = "none";
});

  // Page 5: Journal
  function initJournalPage() {
    const saveButton = document.getElementById("saveNote");
    saveButton.addEventListener("click", saveJournalEntry);
    
    // Pas de chargement depuis localStorage
    renderJournalEntries();
  }

  function saveJournalEntry() {
    const noteInput = document.getElementById("note");
    const dateInput = document.getElementById("journalDate");
    const emotionSelect = document.getElementById("emotion");
    const authorSelect = document.getElementById("author");
    const journal = document.getElementById("journal");

    if(!noteInput.value || !dateInput.value || !authorSelect.value) {
      alert("Remplis la note, la date et l'auteur ü§ç");
      return;
    }

    const newEntry = {
      date: dateInput.value,
      emotion: emotionSelect.value,
      author: authorSelect.value,
      text: noteInput.value,
      id: Date.now()
    };

    journalEntries.push(newEntry);

    const noteCard = createNoteCard(newEntry);
    journal.prepend(noteCard);

    // Reset
    noteInput.value = "";
    dateInput.value = "";
    emotionSelect.value = "";
    authorSelect.value = "";
  }

  function createNoteCard(entry) {
    const noteCard = document.createElement("div");
    noteCard.className = "note-card";
    noteCard.dataset.id = entry.id;

    noteCard.innerHTML = `
      <div><strong>Date :</strong> <span class="date-text">${entry.date}</span></div>
      <div><strong>√âmotion :</strong> <span class="emotion-text">${entry.emotion || "--"}</span></div>
      <div><strong>Auteur :</strong> <span class="author-text">${entry.author}</span></div>
      <div class="note-text">${entry.text}</div>
      <div class="actions">
        <button class="edit">Modifier</button>
        <button class="delete">Supprimer</button>
      </div>
    `;

    // Supprimer
    noteCard.querySelector(".delete").addEventListener("click", () => {
      journalEntries = journalEntries.filter(e => e.id !== entry.id);
      noteCard.remove();
      saveAllData(); // Ajout: sauvegarde apr√®s suppression
    });

    // Modifier
    noteCard.querySelector(".edit").addEventListener("click", () => {
      document.getElementById("note").value = noteCard.querySelector(".note-text").innerText;
      document.getElementById("journalDate").value = noteCard.querySelector(".date-text").innerText;
      document.getElementById("emotion").value = noteCard.querySelector(".emotion-text").innerText;
      document.getElementById("author").value = noteCard.querySelector(".author-text").innerText;

      journalEntries = journalEntries.filter(e => e.id !== entry.id);
      noteCard.remove();
      saveAllData(); // Ajout: sauvegarde apr√®s modification
    });

    return noteCard;
  }

  function renderJournalEntries() {
    const journal = document.getElementById("journal");
    journal.innerHTML = "";
    
    // Trier par date (plus r√©cent d'abord)
    journalEntries.sort((a, b) => new Date(b.date) - new Date(a.date));
    
    journalEntries.forEach(entry => {
      const noteCard = createNoteCard(entry);
      journal.appendChild(noteCard);
    });
  }
  
  // ============================
// Page 6: Carnet de rendez-vous
// ============================

// Tableau pour stocker les rendez-vous
let rdvEntries = [];

// Initialisation de la page rendez-vous (Page 6)
function initRdvPage() {
  // Bouton "Ajouter le rendez-vous"
  const saveBtn = document.getElementById("saveRdv");
  saveBtn.addEventListener("click", saveRdvEntry);

  // Afficher les rendez-vous existants (vide au d√©part)
  renderRdvEntries();
}

// Fonction pour ajouter ou modifier un rendez-vous
function saveRdvEntry() {
  const date = document.getElementById("rdvDate").value;       // Date du rendez-vous
  const time = document.getElementById("rdvTime").value;       // Heure
  const type = document.getElementById("rdvType").value;       // Type (Consultation, √âchographie, etc.)
  const note = document.getElementById("rdvNote").value;       // Notes suppl√©mentaires

  // V√©rification des champs obligatoires
  if(!date || !time || !type) return alert("Remplis au moins la date, l'heure et le type ü§ç");

  // Cr√©ation de l'objet rendez-vous
  const newEntry = {
    id: Date.now(), // identifiant unique
    date,
    time,
    type,
    note
  };

  // Ajouter au tableau
  rdvEntries.push(newEntry);

  // R√©initialiser les champs du formulaire
  document.getElementById("rdvDate").value = "";
  document.getElementById("rdvTime").value = "";
  document.getElementById("rdvType").value = "";
  document.getElementById("rdvNote").value = "";

  // R√©afficher la liste
  renderRdvEntries();
}

// Fonction pour afficher tous les rendez-vous
function renderRdvEntries() {
  const container = document.getElementById("rdvList");
  container.innerHTML = ""; // vider la liste avant affichage

  // Trier par date et heure
  rdvEntries.sort((a,b) => new Date(a.date + " " + a.time) - new Date(b.date + " " + b.time));

  // Boucle sur chaque rendez-vous
  rdvEntries.forEach(entry => {
    const card = document.createElement("div");
    card.className = "note-card"; // style identique au journal
    card.dataset.id = entry.id;

    card.innerHTML = `
<div>
  <strong>${formatDateTime(entry.date, entry.time)}</strong> ‚Äì ${entry.type}
</div>
      <div>${entry.note || ""}</div>
      <div class="actions">
        <button class="edit">Modifier</button>
        <button class="delete">Supprimer</button>
      </div>
    `;

    // -------------------------
    // Bouton Supprimer
    // -------------------------
    card.querySelector(".delete").addEventListener("click", () => {
      // Retirer l'entr√©e du tableau
      rdvEntries = rdvEntries.filter(e => e.id !== entry.id);
      // R√©afficher la liste

      renderRdvEntries();
      saveAllData(); // Ajout: sauvegarde apr√®s suppression
    });

    // -------------------------
    // Bouton Modifier
    // -------------------------
    card.querySelector(".edit").addEventListener("click", () => {
      // Remplir le formulaire avec les infos du rendez-vous
      document.getElementById("rdvDate").value = entry.date;
      document.getElementById("rdvTime").value = entry.time;
      document.getElementById("rdvType").value = entry.type;
      document.getElementById("rdvNote").value = entry.note;

      // Supprimer l'ancien rendez-vous pour √©viter doublons
      rdvEntries = rdvEntries.filter(e => e.id !== entry.id);
      renderRdvEntries();
      saveAllData(); // Ajout: sauvegarde apr√®s modification
    });

    // Ajouter la carte au DOM
    container.appendChild(card);
  });
}
function initGenderChoice() {
  const radios = document.querySelectorAll('input[name="babyGender"]');

  radios.forEach(radio => {
    radio.addEventListener("change", () => {
      babyGender = radio.value;
      updateParentsText();
    });
  });
}

// ============================
// Page 7: Checklist maternit√©
// ============================

// Tableau pour stocker les items
let checklistItems = [];
let editChecklistIndex = null;

function initChecklistPage() {
  const checklistContainer = document.getElementById("checklistContainer");
  const checklistInput = document.getElementById("checklistInput");
  const addChecklistBtn = document.getElementById("addChecklistBtn");
  const categorySelect = document.getElementById("checklistCategory");
  const customCategoryInput = document.getElementById("checklistCustomCategory");

  // Afficher le champ "Autre" si s√©lectionn√©
  categorySelect.addEventListener("change", () => {
    if (categorySelect.value === "Autre") {
      customCategoryInput.style.display = "block";
    } else {
      customCategoryInput.style.display = "none";
      customCategoryInput.value = "";
    }
  });

  // Ajouter ou modifier un item
  addChecklistBtn.addEventListener("click", () => {
    const text = checklistInput.value.trim();
    let category = categorySelect.value;

    if (!text) return alert("√âcris un item ü§ç");

    if (category === "Autre") {
      category = customCategoryInput.value.trim();
      if (!category) return alert("√âcris une cat√©gorie ü§ç");
    }

    if (!category) category = "Non cat√©goris√©";

    if (editChecklistIndex !== null) {
      checklistItems[editChecklistIndex] = { text, category, done: checklistItems[editChecklistIndex].done };
      editChecklistIndex = null;
      addChecklistBtn.textContent = "Ajouter";
    } else {
      checklistItems.push({ text, category, done: false });
    }

    checklistInput.value = "";
    categorySelect.value = "";
    customCategoryInput.value = "";
    customCategoryInput.style.display = "none";

    renderChecklist();
    saveAllData(); // Ajout: sauvegarde apr√®s modification
  });

  renderChecklist();
}

// Fonction pour afficher les items de la checklist
function renderChecklist() {
  const checklistContainer = document.getElementById("checklistContainer");
  if (!checklistContainer) return;
  
  checklistContainer.innerHTML = "";

  checklistItems.forEach((item, index) => {
    const div = document.createElement("div");
    div.className = "week-card";
    div.style.display = "flex";
    div.style.alignItems = "center";
    div.style.justifyContent = "space-between";
    div.style.marginBottom = "8px";
    div.style.padding = "8px";
    div.style.borderRadius = "14px";
    div.style.background = "rgba(255,255,255,0.85)";

    // Partie checkbox + texte
    const leftDiv = document.createElement("div");
    leftDiv.style.display = "flex";
    leftDiv.style.alignItems = "center";
    leftDiv.style.gap = "10px";

    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.checked = item.done;

    const span = document.createElement("span");
    span.textContent = `[${item.category}] ${item.text}`;
    if (item.done) span.style.textDecoration = "line-through";

    checkbox.addEventListener("change", () => {
      item.done = checkbox.checked;
      span.style.textDecoration = item.done ? "line-through" : "none";
      saveAllData(); // Ajout: sauvegarde apr√®s changement d'√©tat
    });

    leftDiv.appendChild(checkbox);
    leftDiv.appendChild(span);

    // Partie boutons Modifier / Supprimer
    const actions = document.createElement("div");
    actions.style.display = "flex";
    actions.style.gap = "6px";

    const editBtn = document.createElement("button");
    editBtn.textContent = "Modifier";
    editBtn.className = "btn btn-secondary";
    editBtn.style.padding = "6px 10px";
    editBtn.style.fontSize = "13px";
    editBtn.addEventListener("click", () => {
      const checklistInput = document.getElementById("checklistInput");
      const categorySelect = document.getElementById("checklistCategory");
      const customCategoryInput = document.getElementById("checklistCustomCategory");
      const addChecklistBtn = document.getElementById("addChecklistBtn");
      
      checklistInput.value = item.text;
      categorySelect.value = item.category !== "Non cat√©goris√©" ? item.category : "Autre";
      if (item.category === "Autre") {
        customCategoryInput.style.display = "block";
        customCategoryInput.value = item.category;
      }
      addChecklistBtn.textContent = "Mettre √† jour";
      editChecklistIndex = index;
    });

    const delBtn = document.createElement("button");
    delBtn.textContent = "Supprimer";
    delBtn.className = "btn btn-secondary";
    delBtn.style.padding = "6px 10px";
    delBtn.style.fontSize = "13px";
    delBtn.addEventListener("click", () => {
      if (confirm("Supprimer cet item ?")) {
        checklistItems.splice(index, 1);
        renderChecklist();
        saveAllData(); // Ajout: sauvegarde apr√®s suppression
      }
    });

    actions.append(editBtn, delBtn);

    div.appendChild(leftDiv);
    div.appendChild(actions);
    checklistContainer.appendChild(div);
  });
}

// ============================
// Page 8: Pr√©noms favoris
// ============================

let prenoms = [];

function initPrenomsPage() {
  const prenomInput = document.getElementById("prenomInput");
  const prenomGenre = document.getElementById("prenomGenre");
  const addPrenomBtn = document.getElementById("addPrenomBtn");
  const prenomContainer = document.getElementById("prenomContainer");

  addPrenomBtn.addEventListener("click", () => {
    const text = prenomInput.value.trim();
    const genre = prenomGenre.value;

    if (!text) return alert("√âcris un pr√©nom ü§ç");

    prenoms.push({ text, genre, fav: false });
    prenomInput.value = "";
    prenomGenre.value = "mixte";
    renderPrenoms();
    saveAllData(); // Ajout: sauvegarde apr√®s ajout
  });

  // Filtres
  const filterButtons = document.querySelectorAll(".filter-prenom .btn");
  filterButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      const filter = btn.dataset.filter;
      renderPrenoms(filter);
    });
  });

  renderPrenoms();
}

function renderPrenoms(filter = "all") {
  const prenomContainer = document.getElementById("prenomContainer");
  if (!prenomContainer) return;
  
  prenomContainer.innerHTML = "";
  
  prenoms.forEach((p, index) => {
    if (filter === "fav" && !p.fav) return;
    if (filter !== "all" && filter !== "fav" && p.genre !== filter) return;

    const div = document.createElement("div");
    div.className = "prenom-item";

    const info = document.createElement("div");
    info.className = "info";

    const spanText = document.createElement("span");
    spanText.textContent = p.text;

    const spanGender = document.createElement("span");
    spanGender.className = "gender " + p.genre;
    spanGender.textContent = p.genre === "garcon" ? "Gar√ßon" : 
                           p.genre === "fille" ? "Fille" : "Mixte";

    info.appendChild(spanText);
    info.appendChild(spanGender);

    const actions = document.createElement("div");
    actions.className = "actions";

    const favBtn = document.createElement("button");
    favBtn.textContent = "‚≠ê";
    favBtn.className = "fav";
    favBtn.addEventListener("click", () => {
      p.fav = !p.fav;
      renderPrenoms(filter);
      saveAllData(); // Ajout: sauvegarde apr√®s changement favori
    });

    const delBtn = document.createElement("button");
    delBtn.textContent = "üóëÔ∏è";
    delBtn.className = "delete";
    delBtn.addEventListener("click", () => {
      prenoms.splice(index, 1);
      renderPrenoms(filter);
      saveAllData(); // Ajout: sauvegarde apr√®s suppression
    });

    actions.append(favBtn, delBtn);

    div.appendChild(info);
    div.appendChild(actions);
    prenomContainer.appendChild(div);
  });
}

// ==========================================================================
// BOUTON DE R√âINITIALISATION (OPTIONNEL) - AJOUT√â POUR G√âRER LE LOCALSTORAGE
// ==========================================================================

// Ajouter un bouton pour r√©initialiser toutes les donn√©es (optionnel)
function addResetButton() {
  if (!document.getElementById('resetBtn')) {
    const resetBtn = document.createElement('button');
    resetBtn.id = 'resetBtn';
    resetBtn.textContent = 'üîÅ R√©initialiser';
    resetBtn.style.position = 'fixed';
    resetBtn.style.bottom = '10px';
    resetBtn.style.right = '10px';
    resetBtn.style.zIndex = '1000';
    resetBtn.style.padding = '8px 12px';
    resetBtn.style.borderRadius = '20px';
    resetBtn.style.background = '#ff6b6b';
    resetBtn.style.color = 'white';
    resetBtn.style.border = 'none';
    resetBtn.style.fontSize = '12px';
    resetBtn.style.cursor = 'pointer';
    
    resetBtn.addEventListener('click', () => {
      if (confirm('Voulez-vous vraiment tout r√©initialiser ? Toutes les donn√©es seront supprim√©es.')) {
        localStorage.removeItem('petitNousData');
        location.reload();
      }
    });
    
    document.body.appendChild(resetBtn);
  }
}

// Appeler cette fonction au chargement si vous voulez le bouton de r√©initialisation
// window.onload = function() { addResetButton(); ... }

</script>
</body>
</html>
